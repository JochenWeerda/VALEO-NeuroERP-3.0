{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "InteractionEvent",
  "type": "object",
  "required": ["id", "timestamp", "channel", "direction", "actor", "customer_ref", "subject"],
  "properties": {
    "id": { "type": "string", "format": "uuid" },
    "timestamp": { "type": "string", "format": "date-time" },
    "channel": {
      "type": "string",
      "enum": ["email", "phone", "sms", "whatsapp", "social", "webform", "api", "meeting", "chatbot"]
    },
    "direction": { "type": "string", "enum": ["inbound", "outbound", "internal"] },
    "actor": {
      "type": "object",
      "required": ["type", "id"],
      "properties": {
        "type": { "type": "string", "enum": ["user", "bot", "system", "customer", "partner"] },
        "id": { "type": "string" },
        "display_name": { "type": "string" }
      }
    },
    "customer_ref": {
      "$ref": "customer_reference.schema.json"
    },
    "subject": { "type": "string" },
    "body": { "type": "string" },
    "summary": { "type": "string" },
    "attachments": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "filename"],
        "properties": {
          "id": { "type": "string" },
          "filename": { "type": "string" },
          "content_type": { "type": "string" },
          "size_bytes": { "type": "integer" }
        }
      }
    },
    "correlation_id": { "type": "string" },
    "related_entities": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["type", "id"],
        "properties": {
          "type": { "type": "string" },
          "id": { "type": "string" },
          "relationship": { "type": "string" }
        }
      }
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" }
    },
    "sentiment": { "type": "string", "enum": ["positive", "neutral", "negative"] },
    "metadata": { "type": "object" }
  }
}
